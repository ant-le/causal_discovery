# @package _global_
name: "full_audit"

# Inherits training setup from competence (usually) but defines specific test suite
defaults:
  - train_competence
  - _self_

data:
  test_families:
    # -----------------------------------------------------------------------
    # 1. Functional Shifts (Square, Periodic)
    # -----------------------------------------------------------------------
    ood_square:
      name: ood_square
      n_nodes: 20
      graph_cfg:
        type: er
        sparsity: 0.2
      mech_cfg:
        type: square
        weight_scale: 1.0
        noise_scale: 0.1
    
    ood_periodic:
      name: ood_periodic
      n_nodes: 20
      graph_cfg:
        type: er
        sparsity: 0.2
      mech_cfg:
        type: periodic
        weight_scale: 1.0
        noise_scale: 0.1

    # -----------------------------------------------------------------------
    # 2. Chaos (Logistic Map)
    # -----------------------------------------------------------------------
    ood_logistic_map:
      name: ood_logistic_map
      n_nodes: 20
      graph_cfg:
        type: er
        sparsity: 0.2
      mech_cfg:
        type: logistic_map
        weight_scale: 1.0

    # -----------------------------------------------------------------------
    # 3. Post-Nonlinear (PNL)
    # -----------------------------------------------------------------------
    ood_pnl_cube:
      name: ood_pnl_cube
      n_nodes: 20
      graph_cfg:
        type: er
        sparsity: 0.2
      mech_cfg:
        type: pnl
        nonlinearity_type: cube
        inner_config:
          type: linear
    
    ood_pnl_sigmoid:
      name: ood_pnl_sigmoid
      n_nodes: 20
      graph_cfg:
        type: er
        sparsity: 0.2
      mech_cfg:
        type: pnl
        nonlinearity_type: sigmoid
        inner_config:
          type: linear

    ood_pnl_tanh:
      name: ood_pnl_tanh
      n_nodes: 20
      graph_cfg:
        type: er
        sparsity: 0.2
      mech_cfg:
        type: pnl
        nonlinearity_type: tanh
        inner_config:
          type: linear

    # -----------------------------------------------------------------------
    # 4. Structural (SBM)
    # -----------------------------------------------------------------------
    ood_sbm_strong:
      name: ood_sbm_strong
      n_nodes: 20
      graph_cfg:
        type: sbm
        n_blocks: 4
        p_intra: 0.6
        p_inter: 0.01  # Very sparse connections between blocks
      mech_cfg:
        type: linear
    
    ood_sbm_weak:
      name: ood_sbm_weak
      n_nodes: 20
      graph_cfg:
        type: sbm
        n_blocks: 4
        p_intra: 0.3
        p_inter: 0.1
      mech_cfg:
        type: linear

    # -----------------------------------------------------------------------
    # 5. References
    # -----------------------------------------------------------------------
    ref_linear:
      name: ref_linear
      n_nodes: 20
      graph_cfg:
        type: er
        sparsity: 0.2
      mech_cfg:
        type: linear

    ref_gp:
      name: ref_gp
      n_nodes: 20
      graph_cfg:
        type: er
        sparsity: 0.2
      mech_cfg:
        type: gp

hydra:
  run:
    dir: ${oc.env:CAUSAL_META_RUN_DIR,experiments/${name}/${now:%Y-%m-%d}/${now:%H-%M-%S}}
  sweep:
    dir: ${oc.env:CAUSAL_META_SWEEP_DIR,experiments/${name}/multirun/${now:%Y-%m-%d}/${now:%H-%M-%S}}
    subdir: ${hydra.job.num}
